<!-- HTML 结构 -->
<div class="copy-code-container">
  <button id="copyButton"> </button>
  <div id="copySuccess" class="copy-success" style="display: none;">
    copied!
  </div>
</div>

<style>
  /* 简单的样式，按需调整 */
  .copy-code-container {
    position: absolute;
    top: 200px;
    right: 100px;
  }
  .copy-success {
    color: green;
    margin-top: 10px;
  }
  #copyButton {
    border: none;
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' height='20' width='20' stroke='rgba(128,128,128,1)' stroke-width='2' viewBox='0 0 24 24'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2M9 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2'/%3E%3C/svg%3E");
    border-radius: 4px;
    width: 40px;
    height: 40px;
    background-color: #f0eeee;
    opacity: 1;
    cursor: pointer;
    background-position: 50%;
    background-size: 20px;
    background-repeat: no-repeat;
    transition: opacity 0.4s;
  }
  #copyButton:hover {
    opacity: 1;
  }
</style>

<script>
  document.getElementById("copyButton").addEventListener("click", async () => {
    var codeBlock = document.querySelector(".astro-code");
    var tempTextArea = document.createElement("textarea");
    tempTextArea.value = codeBlock.innerText;
    document.body.appendChild(tempTextArea);

    tempTextArea.select();
    tempTextArea.setSelectionRange(0, 99999);

    try {
      await navigator.clipboard.writeText(tempTextArea.value);
      // 显示复制成功的提示
      document.getElementById("copySuccess").style.display = "block";
      document.getElementById("copyButton").style.display = "none";
    } catch (err) {
      console.error("复制时发生错误", err);
    }

    document.body.removeChild(tempTextArea);
    setTimeout(() => {
      document.getElementById("copySuccess").style.display = "none";
      document.getElementById("copyButton").style.display = "block";
    }, 2000);
  });
</script>
